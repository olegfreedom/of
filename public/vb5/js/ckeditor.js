window.vBulletin=window.vBulletin||{};window.vBulletin.phrase=window.vBulletin.phrase||{};window.vBulletin.phrase.precache=window.vBulletin.phrase.precache||[];window.vBulletin.phrase.precache.push("wrap_x_tags","insert_video","retrieve_remote_file_and_ref_local");window.vBulletin.options=window.vBulletin.options||{};window.vBulletin.options.precache=window.vBulletin.options.precache||[];window.vBulletin.options.precache=$.merge(window.vBulletin.options.precache,[]);vBulletin.ckeditor=vBulletin.ckeditor||{};if(typeof (pageData.ckeditorCss)!="undefined"){CKEDITOR.config.contentsCss=pageData.ckeditorCss}CKEDITOR.config.toolbar_vBulletinFull=(function(){var D=[["EnhancedSource","Source","RemoveFormat","PasteText","PasteFromWord"],["Font","FontSize"],["TextColor","-","Undo","Redo"],["Bold","Italic","Underline"],["JustifyLeft","JustifyCenter","JustifyRight"],["NumberedList","BulletedList","Outdent","Indent"],["Link","Email","Unlink","Image","Video"],["Quote"],["Code","Html","Php"],["Table","TableProperties","DeleteTable","-","InsertRowBefore","InsertRowAfter","DeleteRow","-","InsertColumnBefore","InsertColumnAfter","DeleteColumn"],["Subscript","Superscript","HorizontalRule"]];if(jQuery.type(window.vBulletin.customBbcode)!=="undefined"){var B=[];for(var A in window.vBulletin.customBbcode){if(!A){continue}var C=window.vBulletin.customBbcode[A];B.push(C.title)}if(B.length>0){D[D.length]=B}}return D})();var CK2BB={Font:"font",FontSize:"size",TextColor:"color",Bold:"b",Italic:"i",Underline:"u",Subscript:"sub",Superscript:"sup",HorizontalRule:"hr",Table:"table",TableProperties:"table",DeleteTable:"table",InsertRowBefore:"table",InsertRowAfter:"table",DeleteRow:"table",InsertColumnBefore:"table",InsertColumnAfter:"table",DeleteColumn:"table",JustifyLeft:"left",JustifyCenter:"center",JustifyRight:"right",NumberedList:"list",BulletedList:"list",Outdent:"indent",Indent:"indent",Link:"url",Email:"email",Unlink:"url",Quote:"quote",Code:"code",Html:"html",Php:"php"};CKEDITOR.config.baseHref=pageData.baseurl+"/";CKEDITOR.config.smiley_path=pageData.baseurl_core+"/";CKEDITOR.config.enterMode=CKEDITOR.ENTER_BR;CKEDITOR.config.entities=false;CKEDITOR.config.height=70;CKEDITOR.config.width="100%";CKEDITOR.config.autoGrow_minHeight=70;CKEDITOR.config.autoGrow_maxHeight=800;CKEDITOR.config.contentsLangDirection=pageData.textdirection;vBulletin.ckeditor.config={toolbar:"vBulletinFull",customConfig:"",toolbarCanCollapse:false,resize_dir:"vertical",removePlugins:"about,contextmenu,elementspath,link,smiley,tabletools,liststyle,resize,sourcearea",extraPlugins:"vblink,vbwrapbuttons,vbsource,videotag,autosave",pluginPath:pageData.baseurl+"/js/ckeplugins/",tabIndex:1,disableNativeSpellChecker:false,filebrowserImageUploadUrl:pageData.baseurl+"/uploader/CKEditorInsertImage"};(function(){var A=vBulletin.ckeditor.config.extraPlugins.split(",");for(var B=0;B<A.length;B++){try{if(!CKEDITOR.plugins.get(A[B])){console.log("Ckeditor: Plugin Loaded: "+pageData.baseurl+"/js/ckeplugins/"+A[B]+"/plugin.js");CKEDITOR.plugins.addExternal(A[B],vBulletin.ckeditor.config.pluginPath+A[B]+"/","plugin.js")}}catch(C){console.warn("Ckeditor: Plugin failed to load: "+pageData.baseurl+"/js/ckeplugins/"+A[B]+"/plugin.js")}}})();vBulletin.ckeditor.instances={};vBulletin.ckeditor.initFocus=function(B,A){if($("#"+B).is(".js-ckeditor-init-on-focus")||$("#"+B).is(".js-ckeditor-focus-editor-after-init")){A.focus();console.log("Ckeditor: Focus on editor for editor: {0}".format(B))}};vBulletin.ckeditor._isEmptyData=function(A){A=A+"";if(A.length>1000){return false}if(A.match(/<(ol|ul|li|img|hr)/)||A.match(/<(div|ol|ul|li|img) style="(margin-left|margin-right|text-align)/)){return false}A=$("<div />").append(A).text();A=$.trim(A).replace(/&nbsp;|\s|\n|\t/g,"");return !A};vBulletin.ckeditor.initPlaceholder=function(D,C){var E=$("#"+D),J=E.closest(".b-editor").find(".cke_contents"),I=E.attr("placeholder");C=C||vBulletin.ckeditor.getEditor(D);console.log("Ckeditor: Initializing placeholder text");if(!I){console.warn("Ckeditor: Placeholder text: No placeholder text");return }var G=J.find(".b-editor__placeholder");if(G.length==0){G=$("<div />").text(I).addClass("b-editor__placeholder h-hide placeholder").appendTo(J)}var B=function(K){return K.document?K.document.getBody():null};var F=function(K){if(K&&!K.hasClass("js-vbulletin-has-placeholder-events")){console.log("Ckeditor: Placeholder text: attachBodyEventHandlers");K.on("keydown",H);K.on("drop",H);K.addClass("js-vbulletin-has-placeholder-events")}};var A=true;var H=function(K){window.setTimeout(function(){var L=B(C);if(L){F(L);var P=vBulletin.ckeditor._isEmptyData(L.getHtml());G.toggleClass("h-hide",!P);if(A&&!P){var M=E.closest(".js-content-entry"),O=M.find(".js-human-verification"),N=O.find(".imagereg");M.find(".js-button-group").removeClass("h-hide");O.removeClass("h-hide");if(N.height()!=N.attr("height")){O.find(".refresh_imagereg").click()}A=false}}},10)};C.on("saveSnapshot",H);C.on("afterCommandExec",H);F(B(C));C.on("mode",function(K){if(K.editor.mode!="source"){vBulletin.ckeditor.initPlaceholder(D)}});H()};vBulletin.ckeditor.initToolbarCloseButton=function(B,A){var E=$("#"+B),D=E.closest(".b-editor").find(".cke_top");var C=$("<span />").addClass("b-icon b-icon__x-circle--dark h-right js-link js-contententry-panel-x h-margin-right-m h-margin-top-m").text("x").appendTo(D)};vBulletin.ckeditor.modifyDialogs=function(C,A){var B=vBulletin.ckeditor.getEditor(C);CKEDITOR.on("dialogDefinition",function(E){var F=E.data.name;var G=E.data.definition;switch(F){case"image":G.removeContents("advanced");G.removeContents("Link");var D=G.getContents("info");D.remove("remote");D.add({type:"checkbox",id:"remote",label:vBulletin.phrase.get("retrieve_remote_file_and_ref_local"),validate:function(){if(this.getValue()){var J=this.getDialog();var I=J.getContentElement("info","txtUrl");var H=I.getValue();if(!H){return true}J.disableButton("ok");J.disableButton("cancel");var L=false;var K=this;vBulletin.AJAX({async:false,url:vBulletin.getAjaxBaseurl()+"/uploader/url",data:{urlupload:H,attachment:1},skipdefaultsuccess:true,success:function(M){if(M.errors){var N=M.errors;if($.isArray(N)&&N.length>0){N=N[0]}alert(vBulletin.phrase.get("error_x",vBulletin.phrase.get(N)))}else{if(M.imageUrl){I.setValue(M.imageUrl);vBulletin.ckeditor.insertImageAttachment(C,M.filedataid,M.filename);L=true}}},fail:function(N){var O=vBulletin.phrase.get("error_uploading_image");var M="error";if(N&&N.files.length>0){switch(N.files[0].error){case"acceptFileTypes":O=vBulletin.phrase.get("invalid_image_allowed_filetypes_are");M="warning";break}}alert(O)},complete:function(){J.enableButton("ok");J.enableButton("cancel")}});return L}}},"txtAlt");break;default:}});B.on("dialogShow",function(E){var D=E.data;var F=D.getName();switch(F){case"image":D.getContentElement("info","htmlPreview").getElement().hide();D.getContentElement("info","txtAlt").getElement().hide();D.getContentElement("info","txtWidth").getElement().hide();D.getContentElement("info","txtHeight").getElement().hide();D.getContentElement("info","ratioLock").getElement().hide();D.getContentElement("info","txtBorder").getElement().hide();D.getContentElement("info","txtHSpace").getElement().hide();D.getContentElement("info","txtVSpace").getElement().hide();D.getContentElement("info","cmbAlign").getElement().hide();D.on("selectPage",function(H){var G=H.data.page;switch(G){case"Upload":var I=$(D.getElement().$).find("iframe.cke_dialog_ui_input_file").contents().find("form");if(I.find('input[name="securitytoken"]').length){I.find('input[name="securitytoken"]').val(pageData.securitytoken)}else{I.append('<input type="hidden" name="securitytoken" value="'+pageData.securitytoken+'" />')}break}});break;default:}})};vBulletin.ckeditor.killImageFloat=function(C,A){var B=vBulletin.ckeditor.getEditor(C);var D=B.getCommand("justifyright");$.each(D._.events.exec.listeners,function(E,F){D.removeListener("exec",F.fn)});$.each(D._.events.refresh.listeners,function(E,F){D.removeListener("refresh",F.fn)});var D=B.getCommand("justifyleft");$.each(D._.events.exec.listeners,function(E,F){D.removeListener("exec",F.fn)});$.each(D._.events.refresh.listeners,function(E,F){D.removeListener("refresh",F.fn)});var D=B.getCommand("justifycenter");$.each(D._.events.refresh.listeners,function(E,F){D.removeListener("refresh",F.fn)})};vBulletin.ckeditor.initSmilies=function(B,A){A.on("mode",function(C){if(C.editor.mode=="source"){$("#"+B).closest(".js-content-entry").find(".js-smilie-container .js-smilie-button").addClass("b-smilie__button--disabled")}else{$("#"+B).closest(".js-content-entry").find(".js-smilie-container .js-smilie-button").removeClass("b-smilie__button--disabled")}})};vBulletin.ckeditor.isEditorEmpty=function(A){var B=vBulletin.ckeditor.getEditorContent(A);if(B===false||B===""){return true}return vBulletin.ckeditor._isEmptyData(B)};vBulletin.ckeditor.resetEditor=function(B){B=vBulletin.ckeditor.verifyEditorId(B);var A=vBulletin.ckeditor.getEditor(B);if(!A){return false}A.setData("")};vBulletin.ckeditor.maintainContent=function(B,A){};vBulletin.ckeditor.convertToAdvancedEditor=function(A){};vBulletin.ckeditor.convertToBasicEditor=function(A){};vBulletin.ckeditor.toggleAdvancedAndBasicEditor=function(B,A){};vBulletin.ckeditor.toggleToolbar=function(C,D,B){var E=$(C);if(typeof D=="undefined"){E.closest(".b-editor").toggleClass("b-editor--cke-toolbar-is-hidden")}else{E.closest(".b-editor").toggleClass("b-editor--cke-toolbar-is-hidden",!D)}var A=!E.closest(".b-editor").hasClass("b-editor--cke-toolbar-is-hidden");E.closest(".js-content-entry").find(".js-toolbar-secondary .b-toolbar__item").filter(function(){return($(this).data("panel")=="b-content-entry-panel__content--toggle-editor")}).toggleClass("b-toolbar__item--active",A);if(!B){$.cookie(pageData.cookie_prefix+"showcketoolbar",(A?1:0),{path:pageData.cookie_path,domain:pageData.cookie_domain,expires:365})}};vBulletin.ckeditor.doInitEditor=function(A,J){if(CKEDITOR.env.mobile&&!CKEDITOR.env.isCompatible){console.log("Ckeditor: Not supported on this mobile device");vBulletin.ckeditor.hideLoadingDialog(A);return }console.log("Ckeditor: Initializing editor: {0}".format(A));var F=$("#"+A);F.trigger("beforeInit",[A]);if(vBulletin.ckeditor.editorExists(A)){console.log("The editor ({0}) already exists.".format(A));return }if(F.is(":visible")&&F.val()==""){F.val(" ")}var D=F.data("disable-features");if(D){if(D=="all"){console.log("Ckeditor: Disabling features: All");vBulletin.ckeditor.config.toolbar=[]}else{D=D.split(",");var C=CKEDITOR.config["toolbar_"+vBulletin.ckeditor.config.toolbar];var I,E,B,G;for(E=0;E<C.length;E++){for(B=0;B<C[E].length;B++){I=C[E][B];if(I.length==0||I=="-"||!CK2BB[I]){continue}if(jQuery.inArray(CK2BB[I],D)>=0){console.log("Ckeditor: Disabling feature: "+I);delete CKEDITOR.config["toolbar_"+vBulletin.ckeditor.config.toolbar][E][B]}}}}}var H=(typeof J.showToolbar=="undefined"?false:J.showToolbar);vBulletin.ckeditor.toggleToolbar(F,H,true);F.ckeditor(function(){vBulletin.ckeditor.hideLoadingDialog(A);vBulletin.ckeditor.instances[A]=this;vBulletin.ckeditor.initPlaceholder(A,this);this.on("focus",function(O){var K=$("#"+A).closest(".js-content-entry"),M=K.find(".js-human-verification"),L=M.find(".imagereg");K.find(".js-button-group").removeClass("h-hide");M.removeClass("h-hide");if(L.height()!=L.attr("height")){M.find(".refresh_imagereg").click()}var N=$.cookie(pageData.cookie_prefix+"showcketoolbar");if(N!="null"){var P=N==1?true:false;if(P){vBulletin.ckeditor.toggleToolbar($("#"+A),P)}}});vBulletin.ckeditor.initFocus(A,this);vBulletin.ckeditor.initToolbarCloseButton(A,this);vBulletin.ckeditor.initSmilies(A,this);vBulletin.ckeditor.killImageFloat(A,this);vBulletin.ckeditor.modifyDialogs(A,this);console.log("Ckeditor: Editor initialized: {0}".format(A));if(F.closest("form").length>0){F.closest("form").attr("ck-editorid",A);console.log('Ckeditor: Added editorId "'+A+'" to form')}F.trigger("afterInit",[A]);vBulletin.ckeditor.fireCallbacks(A,J,"success",this);this.on("afterSetData",function(K){vBulletin.ckeditor.initPlaceholder(A,this)})},vBulletin.ckeditor.config)};vBulletin.ckeditor.editorExists=function(A){A=vBulletin.ckeditor.verifyEditorId(A);return(typeof vBulletin.ckeditor.instances[A]!="undefined"&&vBulletin.ckeditor.instances[A])};vBulletin.ckeditor.getEditor=function(A){A=vBulletin.ckeditor.verifyEditorId(A);return vBulletin.ckeditor.editorExists(A)?vBulletin.ckeditor.instances[A]:null};vBulletin.ckeditor.closeFileDialog=function(C){var B=vBulletin.ckeditor.getEditor(C);if(B){var A=CKEDITOR.dialog.getCurrent();if(A.getName()=="image"){A.setValueOf("info","remote",false);A.click("ok")}}};vBulletin.ckeditor.insertImageAttachment=function(B,C,D){var A=$("#"+B).closest("form");D=D||"";A.append($("<input />").attr({type:"hidden",name:"filedataids[]"}).val(C)).append($("<input />").attr({type:"hidden",name:"filenames[]"}).val(D))};vBulletin.ckeditor.destroyEditor=function(A){console.log("Ckeditor: Destroying editor: {0}".format(A));A=vBulletin.ckeditor.verifyEditorId(A);if(vBulletin.ckeditor.editorExists(A)){try{vBulletin.ckeditor.getEditor(A).destroy()}catch(B){}vBulletin.ckeditor.instances[A]=null;vBulletin.ckeditor.toggleToolbar($("#"+A),false);return true}else{console.warn("Ckeditor: Not destroyed, because editor {0} does not exist.".format(A))}return false};vBulletin.ckeditor.swapLanguage=function(A){A.editor.on("langLoaded",function(B){CKEDITOR.vBulletin=CKEDITOR.vBulletin||{};if(typeof (CKEDITOR.vBulletin.langInit)=="undefined"&&typeof (window.vBulletin.ckeditorPhrases)!="undefined"){CKEDITOR.vBulletin.langInit=true;$.each(window.vBulletin.ckeditorPhrases,function(D,C){var F=CKEDITOR.lang.en;var E=D.split(".");for(var G=0;G<E.length;G++){if(G==(E.length-1)){F[E[G]]=C}else{if(typeof (F[E[G]])!="object"){F[E[G]]={}}F=F[E[G]]}}});CKEDITOR.lang.en.dir=pageData.textdirection}});CKEDITOR.removeListener("instanceCreated",vBulletin.ckeditor.swapLanguage)};CKEDITOR.on("instanceCreated",vBulletin.ckeditor.swapLanguage);CKEDITOR.on("instanceReady",function(B){var A=B.editor;if(CKEDITOR.env.ie){try{document.execCommand("AutoUrlDetect",false,false)}catch(D){}}var C=$("#cke_contents_"+A.name).children().filter(function(){return this.tagName=="IFRAME"?true:false});if(parseInt(A.config.width)<310){C.hide();C.show()}if("ontouchstart" in document.documentElement){C.get(0).contentWindow.scrollTo(0,10)}});